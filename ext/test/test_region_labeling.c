static guint8 test_rl_image[] = {
  0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
  0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 1, 2, 0, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0,
  0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0,
  0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
};

static gint32 test_rl_regions[] = {
  3, 8, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
  3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3,
  3, 8, 9, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 9, 9, 9, 9, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 8, 8, 8, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 8, 9, 9, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 8,10, 9, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 8, 8, 9, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 9, 9, 9, 9, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 8, 8, 8, 8, 8, 8, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 9, 9, 9, 9, 9, 9, 9, 9, 8, 9, 8, 3,
  3, 8, 9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 3,
  3, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 8, 3,
  3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3,
  3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3
};

static void test_region_labeling(void) {
  RDImage *image = rd_image_new(test_rl_image, 16, 16);
  RDMatrix *labeled = rd_label_image_regions(image);
  g_assert_cmpmem(labeled->data, 256*sizeof(gint32), test_rl_regions, 256*sizeof(gint32));
  rd_matrix_free(labeled);
  free(image);
}
